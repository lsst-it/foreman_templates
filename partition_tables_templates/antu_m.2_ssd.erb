<%#
name: antu m.2 ssd
snippet: false
model: Ptable
oses:
- AlmaLinux
- CentOS
- CentOS_Stream
- Fedora
- RedHat
- Rocky
%>
#Dynamic


BOOT_VG="centos_$(hostname -s)"
DOCKER_VG="docker_$(hostname -s)"

BOOT_DEV=sdb
DOCKER_DEV=sda

cat <<EOF > /tmp/diskpart.cfg
ignoredisk --only-use=${BOOT_DEV},${DOCKER_DEV}
zerombr
clearpart --drives=${BOOT_DEV},${DOCKER_DEV} --all --initlabel

part /boot     --size=1024 --asprimary --ondrive=${BOOT_DEV}
part /boot/efi --size=200  --asprimary --ondrive=${BOOT_DEV} --fstype=efi

part pv.boot   --size=1 --grow --ondisk=${BOOT_DEV}
part pv.docker --size=1 --grow --maxsize=2097152 --ondisk=${DOCKER_DEV}

volgroup ${BOOT_VG} pv.boot
volgroup ${DOCKER_VG} pv.docker

logvol /               --vgname=${BOOT_VG} --size=51200 --name=root
logvol /var/lib/docker --vgname=${DOCKER_VG} --size=1 --grow --name=docker
EOF