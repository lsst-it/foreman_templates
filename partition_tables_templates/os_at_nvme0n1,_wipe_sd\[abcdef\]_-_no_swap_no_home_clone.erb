<%#
name: os at nvme0n1, wipe sd[abcdef] - no swap no home clone
snippet: false
model: Ptable
oses:
- AlmaLinux
- CentOS
- CentOS_Stream
- Fedora
- RedHat
- Rocky
%>
#Dynamic


BOOT_VG="centos_$(hostname -s)"
BOOT_DEV="/dev/nvme0n1"

cat <<EOF > /tmp/diskpart.cfg
ignoredisk --only-use=${BOOT_DEV}
zerombr
clearpart --drives=${BOOT_DEV},/dev/sda,/dev/sdb,/dev/sdc,/dev/sdd,/dev/sde,/dev/sdf --all --initlabel --disklabel=gpt

part /boot     --size=1024 --asprimary --ondrive=${BOOT_DEV} --fstype=ext4
part /boot/efi --size=200  --asprimary --ondrive=${BOOT_DEV} --fstype=efi
part pv.boot   --size=1 --grow --ondisk=${BOOT_DEV} --fstype=xfs

volgroup ${BOOT_VG} pv.boot

logvol /         --vgname=${BOOT_VG} --size=1 --grow --name=root
EOF
